# =============================================================================
# File: technical-docs.yaml
# Project: Lexichord.Modules.Knowledge
# Description: Built-in schema for API and technical documentation entities.
# =============================================================================
# LOGIC: Provides the default entity and relationship type definitions for
#   technical documentation use cases. This schema ships with Lexichord and
#   is copied to the workspace's .lexichord/knowledge/schema/ directory on
#   first initialization.
#
# Entity Types: Product, Component, Endpoint, Parameter, Response, Concept
# Relationship Types: CONTAINS, EXPOSES, ACCEPTS, RETURNS, REQUIRES, RELATED_TO
#
# v0.4.5f: Schema Registry Service (CKVS Phase 1)
# =============================================================================

schema_version: "1.0"
name: "Technical Documentation"
description: "Schema for API and technical documentation entities"

entity_types:
  - name: Product
    description: "A software product or service"
    icon: "package"
    color: "#3b82f6"
    properties:
      - name: name
        type: string
        required: true
        max_length: 200
      - name: version
        type: string
        pattern: "^\\d+\\.\\d+(\\.\\d+)?(-[a-zA-Z0-9]+)?$"
      - name: description
        type: text

  - name: Component
    description: "A module or component within a product"
    icon: "puzzle"
    color: "#10b981"
    properties:
      - name: name
        type: string
        required: true
      - name: type
        type: enum
        values: [module, service, library, package]
      - name: description
        type: text

  - name: Endpoint
    description: "An API endpoint"
    icon: "link"
    color: "#f59e0b"
    properties:
      - name: path
        type: string
        required: true
        pattern: "^\\/[\\w\\-\\/\\{\\}]*$"
      - name: method
        type: enum
        values: [GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS]
        required: true
      - name: description
        type: text
      - name: deprecated
        type: boolean
        default: false
      - name: authentication
        type: enum
        values: [none, api_key, oauth2, bearer, basic]

  - name: Parameter
    description: "An API parameter (path, query, header, or body)"
    icon: "variable"
    color: "#8b5cf6"
    properties:
      - name: name
        type: string
        required: true
      - name: type
        type: string
        required: true
      - name: location
        type: enum
        values: [path, query, header, body]
        required: true
      - name: required
        type: boolean
        default: false
      - name: default_value
        type: string
      - name: description
        type: text
      - name: example
        type: string

  - name: Response
    description: "An API response definition"
    icon: "arrow-right"
    color: "#ec4899"
    properties:
      - name: status_code
        type: number
        required: true
        min: 100
        max: 599
      - name: description
        type: text
      - name: content_type
        type: string
        default: "application/json"

  - name: Concept
    description: "A domain concept or term"
    icon: "book"
    color: "#6366f1"
    properties:
      - name: name
        type: string
        required: true
      - name: definition
        type: text
        required: true
      - name: aliases
        type: array
      - name: category
        type: string

relationship_types:
  - name: CONTAINS
    description: "Parent contains child"
    from: [Product]
    to: [Component, Endpoint]
    cardinality: one_to_many

  - name: EXPOSES
    description: "Component exposes endpoint"
    from: [Component]
    to: [Endpoint]
    cardinality: one_to_many

  - name: ACCEPTS
    description: "Endpoint accepts parameter"
    from: [Endpoint]
    to: [Parameter]
    cardinality: one_to_many
    properties:
      - name: location
        type: enum
        values: [path, query, header, body]

  - name: RETURNS
    description: "Endpoint returns response"
    from: [Endpoint]
    to: [Response]
    cardinality: one_to_many

  - name: REQUIRES
    description: "Entity requires another entity"
    from: [Endpoint, Parameter]
    to: [Parameter, Concept]
    cardinality: many_to_many

  - name: RELATED_TO
    description: "General relationship between concepts"
    from: [Concept]
    to: [Concept]
    cardinality: many_to_many
    directional: false
