# v0.6.7a — Selection Context

**Spec:** LCS-DES-v0.6.7a  
**Module:** `Lexichord.Modules.Agents`  
**Dependencies:** `Lexichord.Abstractions`, `Lexichord.Modules.Editor`

## Summary

Enables sending selected editor text to the Co-pilot chat panel via keyboard shortcut (`Ctrl+Shift+A`) or context menu ("Ask Co-pilot about selection"). The feature automatically generates contextually appropriate prompts based on selection characteristics:

- **Short selection** (<50 chars): "Explain this:"
- **Code-like selection**: "Review this code:"
- **Long selection** (>500 chars): "Summarize this:"
- **Default**: "Improve this:"

## New Files

### Abstractions
- `Contracts/Editor/SelectionChangedEventArgs.cs` — Event args for selection changes
- `Contracts/Editor/ContextMenuItem.cs` — Model for editor context menu items
- `Contracts/IKeyBindingConfiguration.cs` — Interface for key binding registration

### Agents Module
- `Services/ISelectionContextService.cs` — Service interface
- `Services/SelectionContextService.cs` — Service implementation
- `Services/DefaultPromptGenerator.cs` — Prompt generation logic
- `Commands/SelectionContextCommand.cs` — ICommand implementation
- `Events/SelectionContextSetEvent.cs` — MediatR notification
- `Extensions/EditorContextMenuExtensions.cs` — Context menu registration
- `Configuration/SelectionContextKeyBindings.cs` — Keyboard binding setup
- `Views/SelectionContextIndicator.axaml` — UI indicator component
- `Views/SelectionContextIndicator.axaml.cs` — Code-behind

### Tests
- `Modules/Agents/SelectionContextServiceTests.cs` — 6 tests
- `Modules/Agents/DefaultPromptGeneratorTests.cs` — 4 tests
- `Modules/Agents/SelectionContextCommandTests.cs` — 3 tests

## Modified Files

- `Contracts/Editor/IEditorService.cs` — Added `GetSelectedText()`, `SelectionChanged`, `RegisterContextMenuItem()`
- `Chat/ViewModels/CoPilotViewModel.cs` — Added selection context properties and methods
- `AgentsModule.cs` — Added DI registrations, updated version to 0.6.7
- `EditorService.cs` — Added stub implementations for new interface members

## Spec Deviations

| Spec | Implementation | Reason |
|------|---------------|--------|
| `HasFeature(LicenseFeature.CoPilotAgent)` | `GetCurrentTier() >= LicenseTier.WriterPro` | `LicenseFeature` enum doesn't exist |
| `LicenseRequiredException` | `LicenseTierException` | Reusing existing exception type |

## Tests: 13/13 Passing ✅
